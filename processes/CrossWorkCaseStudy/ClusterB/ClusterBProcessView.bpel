<!-- OEMProcessView BPEL Process [Generated by the Eclipse BPEL Designer] -->
<!-- Date: Sun Jun 02 23:42:20 CEST 2013 -->
<bpel:process name="ClusterBProcessView"
         targetNamespace="http://www.example.org/CrossWork/WaterTankProduction/"
         suppressJoinFailure="yes"
         xmlns:tns="http://www.example.org/CrossWork/WaterTankProduction/"
         xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/abstract"
         xmlns:esrc="http://www.cs.helsinki.fi/u/anorta/research/eSourcing/"
         >

	<bpel:extensions>
		<bpel:extension namespace="http://www.cs.helsinki.fi/u/anorta/research/eSourcing/" mustUnderstand="yes" />
	</bpel:extensions>

    <!-- Import the client WSDL -->
    <bpel:import location="../WaterTankProduction.wsdl" namespace="http://www.example.org/CrossWork/WaterTankProduction/"
	        importType="http://schemas.xmlsoap.org/wsdl/" />

    <!-- ================================================================= -->
    <!-- ORCHESTRATION LOGIC                                               -->
    <!-- Set of activities coordinating the flow of messages across the    -->
    <!-- services integrated within this business process                  -->
    <!-- ================================================================= -->
    <bpel:partnerLinks>
        <bpel:partnerLink name="productionPL" partnerLinkType="tns:WaterTankProductionPLT" partnerRole="producer"></bpel:partnerLink>
    </bpel:partnerLinks>
    <bpel:variables>
        <bpel:variable name="productionPLRequest" messageType="tns:ProduceSealingRingRequest"></bpel:variable>
        <bpel:variable name="productionPLRequest1" messageType="tns:ProduceGrommetRequest"></bpel:variable>
        <bpel:variable name="productionPLRequest2" messageType="tns:ProduceDispenserRequest"></bpel:variable>
        <bpel:variable name="productionPLRequest3" messageType="tns:ProduceWaterTankBodyRequest"></bpel:variable>
        <bpel:variable name="productionPLRequest4" messageType="tns:AssembleWaterTankRequest"></bpel:variable>
    </bpel:variables>
    <bpel:sequence name="main">

	<bpel:invoke name="prepareOrder" partnerLink="productionPL"
		operation="PrepareOrder" portType="tns:WaterTankProductionPT" esrc:status="invokable"></bpel:invoke>
	<bpel:flow name="Flow">
		<bpel:invoke name="produceSealingRing" partnerLink="productionPL"
			operation="ProduceSealingRing" portType="tns:WaterTankProductionPT"
			inputVariable="productionPLRequest" esrc:status="observable"></bpel:invoke>
		<bpel:invoke name="produceGrommet" partnerLink="productionPL"
			operation="ProduceGrommet" portType="tns:WaterTankProductionPT"
			inputVariable="productionPLRequest1" esrc:status="observable"></bpel:invoke>


	<bpel:sequence name="SEQ">
                <bpel:invoke name="produceWatertankBody" partnerLink="productionPL" operation="ProduceWaterTankBody" portType="tns:WaterTankProductionPT" inputVariable="productionPLRequest3" esrc:status="observable"></bpel:invoke>
                <bpel:invoke name="produceDispenser" partnerLink="productionPL" operation="ProduceDispenser" portType="tns:WaterTankProductionPT" inputVariable="productionPLRequest2" esrc:status="observable"></bpel:invoke>
            </bpel:sequence></bpel:flow>
	<bpel:invoke name="assembleWatertank" partnerLink="productionPL"
		operation="AssembleWaterTank" portType="tns:WaterTankProductionPT"
		inputVariable="productionPLRequest4" esrc:status="observable"></bpel:invoke>
    </bpel:sequence>
</bpel:process>

