<!-- P BPEL Process [Generated by the Eclipse BPEL Designer] -->
<!-- Date: Mon May 16 09:08:35 CEST 2011 -->
<bpel:process name="P"
         targetNamespace="http://www.example.com/watertank/offer2"
         suppressJoinFailure="yes"
         xmlns:tns="http://www.example.com/figure4"
         xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
         xmlns:ns2="http://www.example.org/matching/partner/interface"
         >
         
    <bpel:import namespace="http://www.example.org/matching/partner/interface" location="partner.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>

    <bpel:partnerLinks>
        <bpel:partnerLink name="partner" partnerLinkType="ns2:partnerPLT" partnerRole="partner"></bpel:partnerLink>
	</bpel:partnerLinks>

    <!-- ================================================================= -->         
    <!-- ORCHESTRATION LOGIC                                               -->
    <!-- Set of activities coordinating the flow of messages across the    -->
    <!-- services integrated within this business process                  -->
    <!-- ================================================================= -->         
    <bpel:variables>
        <bpel:variable name="processRequest" messageType="ns1:ReceiveOrderRequest"></bpel:variable>
        <bpel:variable name="processRequest1" messageType="ns1:ReceivePaymentRequestRequest"></bpel:variable>
        <bpel:variable name="partnerRequest" messageType="ns2:PrepareOrderRequest"></bpel:variable>
        <bpel:variable name="partnerRequest1" messageType="ns2:AssembleWatertankRequest"></bpel:variable>
        <bpel:variable name="partnerRequest2" messageType="ns2:ProduceWatertankBodyRequest"></bpel:variable>
        <bpel:variable name="partnerRequest3" messageType="ns2:AssembleMotorpumpRequest"></bpel:variable>
        <bpel:variable name="partnerRequest4" messageType="ns2:ProduceMotorRequest"></bpel:variable>
        <bpel:variable name="partnerRequest5" messageType="ns2:ProducePumpRequest"></bpel:variable>
    </bpel:variables>
	<bpel:sequence name="main">
		<bpel:invoke name="PrepareOrder" partnerLink="partner"
			operation="PrepareOrder" portType="ns2:partner" inputVariable="partnerRequest"></bpel:invoke>
		<bpel:sequence>
			<bpel:invoke name="ProduceWatertankBody" partnerLink="partner"
				operation="ProduceWatertankBody" portType="ns2:partner"
				inputVariable="partnerRequest2"></bpel:invoke>
			<bpel:sequence name="Sequence">
				<bpel:flow name="Flow1">
					<bpel:invoke name="ProduceMotor" partnerLink="partner"
						operation="ProduceMotor" portType="ns2:partner" inputVariable="partnerRequest4"></bpel:invoke>
					<bpel:invoke name="ProducePump" partnerLink="partner"
						operation="ProducePump" portType="ns2:partner" inputVariable="partnerRequest5"></bpel:invoke>
				</bpel:flow>
				<bpel:invoke name="AssembleMotorpump" partnerLink="partner"
					operation="AssembleMotorpump" portType="ns2:partner" inputVariable="partnerRequest3"></bpel:invoke>
			</bpel:sequence>
		</bpel:sequence>
		<bpel:invoke name="AssembleWatertank" partnerLink="partner"
			operation="AssembleWatertank" portType="ns2:partner" inputVariable="partnerRequest1"></bpel:invoke>
	</bpel:sequence>    
</bpel:process>

